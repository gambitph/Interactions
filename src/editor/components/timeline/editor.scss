/* Timeline component */
$timeline-line-color: #a7acb7;
$timeline-line-offset: 40px;
$timeline-line-width: 1px;
$timeline-dot-gap: 12px;
$timeline-dot-size: 5px; // Use odd number

.interact-timeline {
	background: #fff;
	border: 1px solid #0000001a;
	min-height: 200px;
	padding: 6px;
	padding-inline-start: 0;
	position: relative;
	display: flex;
	flex-direction: column;
	font-size: 11px;
	&::before {
		content: "";
		position: absolute;
		top: 0;
		bottom: 0;
		inset-inline-start: $timeline-line-offset;
		width: $timeline-line-width;
		background: $timeline-line-color;
	}
	+ .components-toggle-control {
		margin-top: 8px;
	}
	&.is--empty {
		border: 0;
		padding: 0;
		&::before {
			display: none;
		}
	}
	&:focus {
		border: 1px solid #000 !important;
	}
}
.interact-timeline__item {
	display: grid;
	grid-template-columns: #{ $timeline-line-offset - $timeline-dot-gap * 0.5 } #{ $timeline-dot-gap + $timeline-line-width } 1fr;
	align-items: center;
	justify-content: center;
	user-select: none;
	&.interact-timeline__item--secondary {
		.interact-timeline__time,
		.interact-timeline__dot {
			visibility: hidden;
		}
		.interact-timeline__time-input input:not(:focus) {
			opacity: 0;
			~ .components-input-control__suffix {
				opacity: 0;
			}
		}
		.interact-timeline__time-input input:not(:focus):hover {
			opacity: 0.7;
			~ .components-input-control__suffix {
				opacity: 0.7;
			}
		}
	}
}
.interact-timeline__time {
	text-align: end;
	line-height: 1;
}
.interact-timeline__dot {
	position: relative;
	&::before {
		content: "";
		position: absolute;
		top: 50%;
		left: 50%;
		width: $timeline-dot-size;
		height: $timeline-dot-size;
		border-radius: 100%;
		background: $timeline-line-color;
		transform: translate(-50%, -50%);
	}
}
$timeline-gap: 10px;
$timeline-drop-thickness: 2px;
.interact-timeline__box {
	background: #fff;
	box-shadow: 0 0 0 1px #0000004d;
	display: grid;
	grid-template-columns: 1fr auto;
	padding-inline: 8px;
	height: 30px;
	align-items: center;
	cursor: pointer;
	&:hover,
	&:focus {
		background: #ebedf3;
	}
	&.interact-timeline__box--top:not(.interact-timeline__box--dragging) {
		box-shadow: 0 0 0 1px #0000004d, 0 -1px #05f, inset 0 1px #05f;
		z-index: 3;
	}
	&.interact-timeline__box--bottom:not(.interact-timeline__box--dragging) {
		box-shadow: 0 0 0 1px #0000004d, 0 1px #05f, inset 0 -1px #05f;
		z-index: 3;
	}
	&.interact-timeline__box--dragging {
		opacity: 0.3;
	}
	.interact-timeline__target {
		overflow: hidden;
		text-wrap: nowrap;
		text-overflow: ellipsis;
		margin-right: 8px;
	}
	&.interact-timeline__box--has-warning {
		grid-template-columns: 24px 1fr auto;
		.dashicons {
			color: #d63638;
			width: 16px;
			height: 16px;
			font-size: 16px;
		}
	}
}
.interact-timeline__drop-gap {
	height: $timeline-gap;
	&.is-tall {
		height: 20px;
	}
	width: 100%;
	background: transparent;
	position: relative;
	&.is-force-label::before,
	&.interact-timeline__box--highlight::before {
		content: "";
		position: absolute;
		top: calc($timeline-gap / 2 - $timeline-drop-thickness / 2);
		height: $timeline-drop-thickness;
		background: #05f;
		left: $timeline-line-offset;
		width: calc(100% - $timeline-line-offset);
	}
	&.is-force-label {
		margin-top: 8px;
		height: 10px;
	}
	&.is-force-label:last-child {
		margin-top: 0;
		margin-bottom: 8px;
	}
	&.is-force-label::before {
		background: #0000001c;
	}
	&.is-force-label::after,
	&.interact-timeline__box--highlight::after {
		// &:hover::after {
		content: attr(data-label);
		width: #{ $timeline-line-offset - $timeline-dot-gap * 0.5 };
		display: block;
		text-align: end;
		position: absolute;
		top: -6px;
	}
	// &:not(.interact-timeline__box--highlight) {
	// 	cursor: copy;
	// }
	// &:not(.interact-timeline__box--highlight):hover {
	// 	&::before {
	// 		content: "";
	// 		position: absolute;
	// 		top: calc($timeline-gap / 2 - $timeline-drop-thickness / 2);
	// 		height: $timeline-drop-thickness;
	// 		background: #05f;
	// 		left: $timeline-line-offset;
	// 		width: calc(100% - $timeline-line-offset);
	// 	}
	// }
}
.interact-timeline--percentage {
	.interact-timeline__drop-gap {
		height: 3px;
		&::before {
			top: 1px !important;
		}
		// &:not(.interact-timeline__box--highlight) {
		&.interact-timeline__box--highlight::before {
			content: "";
			position: absolute;
			top: calc($timeline-gap / 2 - $timeline-drop-thickness / 2);
			height: $timeline-drop-thickness;
			background: #05f;
			left: $timeline-line-offset;
			width: calc(100% - $timeline-line-offset);
		}
		// }
	}
	.interact-timeline__drop-gap + .interact-timeline__item,
	.interact-timeline__item + .interact-timeline__item:not(.interact-timeline__item--secondary) {
		margin-top: 6px;
	}
}
.interact-timeline__item--selected .interact-timeline__box {
	border: 1px solid #2b3c7c;
	z-index: 2;
	background: #ddd;
}

/* Action */
.interact-popover.interact-action-popover {
	.components-panel__body {
		width: 350px;
	}
}

.interact-timeline-time-highlight {
	background: var(--wp-admin-theme-color);
	height: 20px;
	position: absolute;
	top: 6px;
	width: 40px;
	left: 0px;
	z-index: 2;
	color: #fff;
	text-align: center;
	line-height: 20px;
	margin-top: 5px;
	user-select: none;
	&::before {
		content: "";
		position: absolute;
		right: -6px;
		bottom: 0;
		width: 0;
		height: 0;
		border-left: 6px solid var(--wp-admin-theme-color);
		border-top: 10px solid transparent;
		border-bottom: 10px solid transparent;
	}
}
.interact-timeline--percentage {
	.interact-timeline-time-highlight {
		margin-top: 0;
		top: 0;
	}
}

.interact-timeline__easing-help {
	font-size: 12px;
	color: #757575;
	margin-top: 0;
}

.interact-timeline__time-input {
	margin: 0 0 0 1px !important;
	transform: translateX(1px);
	.components-input-control__input {
		padding: 0 2px !important;
		text-align: end;
		&:not(:focus) ~ .components-input-control__backdrop {
			opacity: 0;
		}
	}
	.components-input-control__suffix {
		font-size: 11px !important;
	}
	&.is--starting-state .components-input-control__input {
		font-size: 14px !important;
		margin-top: -3px !important;
	}
	.components-input-control__suffix {
		margin-right: 0;
	}
}

.interact-property-control--number,
.interact-property-control--text {
	.components-base-control {
		flex: 1;
	}
	.components-base-control__help {
		margin-top: -8px;
	}
	.components-input-control {
		flex: 0 1;
		flex-basis: 70px;
	}
}

.interact-timeline__type--unknown {
	font-style: italic;
	color: orangered;
	&::after {
		content: "?";
	}
}

/**
 * Styles for the dynamic content / reference popover
 */
.interact-property-control__dynamic-button {
	height: 30px !important;
	width: 30px !important;
	padding: 0 !important;
	display: flex !important;
	justify-content: center;
}
.interact-property-control__dynamic-popover-content {
	width: 350px;
	padding: 8px;
}


.interact-property-control .components-base-control__help code {
	font-size: 12px;
}

.interact-timeline-side-buttons {
	display: flex;
	flex-direction: row;
}
